<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NovaZ</title>

  <script src="./asm80-node/parser.js"></script>
  <script src="./asm80-node/monolith.js"></script>
  <script src="./asm80-node/asm.js"></script>

  <script src="./Z80/Z80.js"></script>

  <script src="./index.js"></script>
  <script src="./video.js"></script>
  <script src="./asm.js"></script>
  <script src="./disasm.js"></script>


  <script>
    function openTab(name) {
      var tabcontent = document.getElementsByClassName("tabcontent");
      for (var i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = 'none';
      }

      document.getElementById(name).style.display = "block";
    }
  </script>

  <style>
    #canvas-container {
      width: 512px;
      height: 512px;
      margin: 30px;
      padding: 10px;
      background-color: #222222;
    }

    #canvas.vm0 {
      transform: scale(4);
    }

    #canvas.vm1 {
      transform: scale(8);
    }

    #canvas.vm2 {
      transform: scale(2);
    }

    #canvas {
      transform-origin: 0 0;
      image-rendering: pixelated;
      border: none;
    }

    #debugger-output {
      position: absolute;
      top: 50px;
      left: 530px;
    }
  </style>
</head>

<body>
  <div class="tabbar">
    <button class="tablink" onclick="openTab('tab-screen')">Screen</button>
    <button class="tablink" onclick="openTab('tab-asm'); setTimeout(asm_show, 0);">Assembler</button>
    <a href="./documentation.html" target="_blank">Documentation</a>
  </div>

  <div id="tab-screen" class="tabcontent">
    <div id="canvas-container">
      <canvas id="canvas"></canvas><br>
    </div>
    <pre id="debugger-output"></pre>

    <button onclick="start()">Start</button>
    <button onclick="stop()">Stop</button>
    <button onclick="do_single_step()">Single Step</button>
    <button onclick="reset()">Reset</button>
    <span id="console-status">Stopped</span> <br>
    <button onclick="set_show_debugger(!SHOW_DEBUGGER);"> Show / hide debugger</button>
    <pre id="debug-frame-time"></pre>
  </div>

  <div id="tab-asm" class="tabcontent">
    <button onclick="do_assemble(false)">Assemble</button>
    <button onclick="do_assemble(true)">Assemble & run</button>
    <span id="save-status"></span><br>
    <span id="assembler-loading">Loading...</span>
    <div name="assembler-input" id="assembler-input" style="width: 800px; height: 600px;"></div> <br>
    <div id="assembler-output"></div>
  </div>

  <script type="text/javascript" src="https://unpkg.com/monaco-editor@latest/min/vs/loader.js"></script>
  <script>
    require.config({ paths: { 'vs': 'https://unpkg.com/monaco-editor@latest/min/vs' } });

    // Before loading vs/editor/editor.main, define a global MonacoEnvironment that overwrites
    // the default worker url location (used when creating WebWorkers). The problem here is that
    // HTML5 does not allow cross-domain web workers, so we need to proxy the instantiation of
    // a web worker through a same-domain script
    window.MonacoEnvironment = {
      getWorkerUrl: function (workerId, label) {
        return `data:text/javascript;charset=utf-8,${encodeURIComponent(`
        self.MonacoEnvironment = {
          baseUrl: 'https://unpkg.com/monaco-editor@latest/min/'
        };
        importScripts('https://unpkg.com/monaco-editor@latest/min/vs/base/worker/workerMain.js');`
        )}`;
      }
    };
  </script>


  <script>
    openTab('tab-screen');
    asm_load();
    on_load();
    start();
  </script>
</body>

</html>